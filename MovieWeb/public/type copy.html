<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Movie-Genre</title>
    <meta title="description" content="">
    <meta title="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.ico">
    
    <!-- CSS 
    ========================= -->
   
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    
    <!-- Fonts CSS -->
    <link rel="stylesheet" href="assets/css/material-design-iconic-font.min.css">
    
    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/css/plugins.css">
    
    <!-- Main Style CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/style1.css">
    
    
    <!-- Modernizer JS -->
    <script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>

    <title>NetFlix</title>

    <link rel="stylesheet" href ="./assets/css/type.css">

    <script src="./assets/js/main.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <!-- movie list css -->
    
</head>

<body>
    <!-- Main Wrapper Start -->
    <div class="main-wrapper">
   
        <header class="header-area">
            <div class="container-fluid1">
                <div class="header-wrap header-netflix-style">
                    <div class="logo-menu-wrap">
                        <!-- Logo -->
                        <div class="logo">
                            <a href="index-4.html"><img src="assets/images/logo.png" alt=""></a>
                        </div>
                        <!-- Logo -->
                        <div class="main-menu main-theme-color-four">
                            <nav class="main-navigation">
                                <ul>
                                    <li><a href="index.html">Home</a></li>
                                    <li><a href="#">Pages</a>
                                        <ul class="sub-menu">
                                            <li><a href="aboutus.html">About Us</a></li>
                                            <li><a href="pricing-plan-2.html">Pricing</a></li>
                                            <!-- <li><a href="watchlist.html">Watchlist</a></li> -->
                                            <li><a href="history2.html">History</a></li>
                                            <!-- <li><a href="movie-details.html">Movie details</a></li> -->
                                            <!-- <li><a href="series-details.html">Series details</a></li> -->
                                            <li><a href="faq-2.html">FAQ</a></li>
                                            <li><a href="account.html">My Account</a></li>
                                            <!-- <li><a href="landing-page.html">Landing Page</a></li> -->
                                        </ul>
                                    </li>
                                    <li><a href="pricing-plan-2.html">Pricing</a></li>
                                    <li><a href="type.html">Search</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                    <div class="right-side">
                        <!-- our-profile-area start -->
                        <div class="our-profile-area">
                            <a href="account.html" class="our-profile-pc" data-bs-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                <img class="img-avatar" src="assets/images/default-avatar2.png" alt="">
                            </a>
                        </div>
                        <!-- our-profile-area end -->
                        <div class="subscribe-btn-wrap">
                            <button onclick="window.location.href='login-original.html'" type="button" data-bs-toggle="modal"
                                data-bs-target="#exampleModal" class="subscribe-btn">Login Now</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

    <!-- movie list-->

    <div class="product-page spad" >
        <div class="container" >
            <div class="row" >
                <div class="col-lg-12" >
                    
                    </div>
                </div>
            </div>
    </div>
    <div class="movie-body">
        <div class="product__page__title" >
            <div class="row" >
                <div class="col-lg-8 col-md-8 col-sm-6" >
                    <div class="section-title" >
                        

                    </div>
                </div>
                <div class="col-lg-4 col-md-4 col-sm-6" >
                    <div class="product__page__filter">
                        
                        
                    </div>
                </div>
            </div>
        </div>
        <div class="row" >
            <div class="col-lg-12">
                <div class="searchBar">
                    <h3 id="current-genre">Genre</h3>
                    
            
                </div>
            </div>
        </div>
        <table style = "width:100%" >
            <tr>
                <td style = "width:25%">
                    <div class = "Film_things">Genre: </div>
                    <div class ="dropdown">
                        <div class = "select">
                            <span class = "selected" id="select-text1" >Select</span>
                            <div class ="caret"></div>
                        </div>
                        <ul class="menu" id="menu-things">
                            <li><p class="menu-attributes menu-attributes-genre">- All -</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Comedy</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Thriller</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">War & Military</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Crime</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Family</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Romance</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Western</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Mystery & Thriller</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Sci-Fi</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Action</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Adventure</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Animation</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Documentary</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Drama</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">History</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Music</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Sport</p></li>
                            <li><p class="menu-attributes menu-attributes-genre">Fantasy</p></li>                                
                            <li><p class = "menu-attributes menu-attributes-genre">Reality TV</p></li>
                        </ul>

                    </div>
                </td>
                <td style = "width:25%">
                    <div class = "Film_things">Age rating:</div>
                    <div class ="dropdown">
                        <div class = "select">
                            <span class = "selected " id="select-text2" >Select</span>
                            <div class ="caret"></div>
                        </div>
                        <ul class="menu menu2">
                                <li><p class = "menu-attributes menu-attributes-age-rating">- All -</p></li>
                                <li ><p class = "menu-attributes menu-attributes-age-rating">U</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">UA</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">A</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">UA7+</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">S</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">UA13+</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">UA16+</p></li>
                                <li><p class = "menu-attributes menu-attributes-age-rating">UA18+</p></li>
                        </ul>

                    </div>
                </td>
                <td style = "width:25%">
                    <div class = "Film_things">Year: </div>
                    <div class ="dropdown">
                        <div class = "select">
                            <span class = "selected " id="select-text3">Select</span>
                            <div class ="caret"></div>
                        </div>
                    
                        <ul class="menu">
                                <li><p class = "menu-attributes menu-attributes-year menu-attributes-year-all">- All -</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2024</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2023</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2022</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2021</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2020</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2019</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2018</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2017</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2016</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2015</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2014</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2013</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2012</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2011</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2024</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2023</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2022</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2021</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2020</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2019</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2018</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2017</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2016</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2015</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2014</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2013</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2012</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2011</p></li>
                                <li><p class = "menu-attributes menu-attributes-year">2010</p></li>
                        </ul>

                    </div>
                </td>
                <td style = "width:25%">
                <div class = "Film_things">Rating: </div>
                <div class ="dropdown">
                    <div class = "select">
                        <span class = "selected " id="select-text4">Select</span>
                        <div class ="caret"></div>
                    </div>
                    <ul class="menu menu4">
                            <li><p class = "menu-attributes menu-attributes-rating menu-attributes-rating-all" id="all-rating">- All -</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">10</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">9</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">8</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">7</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">6</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">5</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">4</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">3</p></li>
                            <li><p class = "menu-attributes menu-attributes-rating">2</p></li>
                            <li ><p class = "menu-attributes menu-attributes-rating">1</p></li>

                    </ul>

                </div>
                </td>
            </tr>
        </table >
        <div class = "sort-area">
        <table style = "width:100%" >
            <tr>
               <td style = "width:75%" ><p class = "Film_things_Sort" align = "right">Sort by: </p></td> 
               <td style = "width:19.5%">
                    <div class ="dropdown">
                    <div class = "select">
                        <span class = "selected ">Select</span>
                        <div class ="caret"></div>
                    </div>
                    <ul class="menu menu5">
                            <li class = "menu_begin menu-attributes menu-attributes-sort" ><p>Rating</p></li>
                            <li class = "menu_last menu-attributes menu-attributes-sort"><p>Year</p></li>

                    </ul>
                    </div>
                </td>
                <td style = "width:5%" >
                    <div class ="dropdown1">
                        <div class = "select1 menu-attributes menu-attributes-sort-button">
                            <span class="selected1 "><i class="fa fa-sort "></i></span>
                        </div>
                    </div>
                </td> 
            </tr>
            

        </table>
        </div>
<!-- Container Fluid Start -->

            <div class="header-wrap header-netflix-style search-area">
                <div class="right-side d-flex  "> 
        
                            <input placeholder="Search" class ="search-movie select_1 select1" id="search-movie1" >
 
                            <div class ="dropdown1">                           
                                <div class = "select1 button-search " >
                                    <span class="selected1 ">
                                        <i class="fa fa-search "></i>    
                                    </span>
                                </div>
                            </div>
                            <div class ="dropdown1 menu-attributes menu-attributes-all-button">                           
                                <div class = "select1  " >
                                    <span class="selected1 ">
                                        All    
                                    </span>
                                </div>
                            </div>   
                </div>
            </div>



<!-- Container Fluid End -->
        <br>
        <br>
        <br>
        <!-- <div class="movie-slider-active nav-style-2"> -->

        <div  id = "movie-list">
            
        </div>

        <!-- <div class="pagination-stuff">         -->
        <table style = "width:100%" >
            <tr>
                <td  style = "width:100%">
                </td>    
                <td  style = "width:20%">
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-page">
                            <span >1</span>
                        </div>
                    </div>
                </td>
                <td style = "width:20%" >
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-page">
                            <span >2</span>
                        </div>
                    </div>
                </td>

                
                </td>    
                <td  style = "width:20%">
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-page">
                            <span >3</span>
                        </div>
                    </div>
                </td>
                <td style = "width:20%" >
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-page">
                            <span >4</span>
                        </div>
                    </div>
                </td>

                <td style = "width:20%" >
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-page">
                            <span>5</span>
                        </div>
                    </div>
                </td>

            </tr>
            

        </table>
        
        <table style = "width:100%" >
            <tr>
                <td  style = "width:100%">
                </td>    
                <td  style = "width:10%">
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-before-button ">
                            <span>&#8592</span>
                        </div>
                    </div>
                </td>
                <td style = "width:20%" >
                    <div class ="dropdown2">
                        <div class = "select2  menu-attributes menu-attributes-next-button">
                            <span>&#8594</span>
                        </div>
                    </div>
                </td>
                
            </tr>
            

        </table>

            
</div>
</div>


<!-- Footer Area -->

    <!--// Footer Area -->
    <!-- Modal -->

</div>
        

        <script src="./assets/js/type.js"></script>           
        <!-- jquery -->		
        <script src="assets/js/vendor/jquery-3.5.1.min.js"></script>
        <script src="assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
        <!-- Popper JS -->
        <script src="assets/js/popper.min.js"></script>
        <!-- Bootstrap JS -->
        <script src="assets/js/bootstrap.min.js"></script>
        <!-- Plugins JS -->
        <script src="assets/js/plugins.js"></script>
        <!-- Ajax Mail -->
        <script src="assets/js/ajax-mail.js"></script>
        <!-- Main JS -->
        <script src="assets/js/main.js"></script>

        <script>
        var movie_genre = "";
        var menuItems = document.querySelectorAll('.menu-attributes');
        var movie_year = "";
        // var movie_year_tmp = "";
        var movie_rating =0;
        var movie_rating_tmp=0;
        var movie_rating_tmp1 = "";
        var rating_flag=0;
        var all_flag=1;
        var movie_age_rating = "";
        var movie_search = "";
        var movie_page = "";
        var movie_page_num = 1;
        var movie_sort_value="";
        var movie_sort_type="";
        var movie_sort_number=1;
        var movie_flag=0;
   
        var container = document.getElementById("movie-list");
        var encodedURL_search_value ="";
        menuItems.forEach(function(item) {
        item.addEventListener('click', function() {
            if(item.classList.contains("menu-attributes-genre")){
                movie_genre = this.textContent.trim();
                // movie_page=1;
            }
            if(item.classList.contains("menu-attributes-year")){
                movie_year =this.textContent.trim();
                movie_year_tmp =this.textContent.trim();
                // movie_page=1;
            }
            if(item.classList.contains("menu-attributes-rating")){
                movie_rating = parseFloat(this.textContent.trim());
                movie_rating_tmp = movie_rating;
                movie_rating_tmp1 = this.textContent.trim();
                rating_flag=1;
                movie_page="";
                console.log("Inside menu-attributes-rating");
                console.log(movie_rating);
                console.log(movie_rating_tmp);
                console.log(movie_rating_tmp1);

            }
            if(item.classList.contains("menu-attributes-age-rating")){
                movie_age_rating = this.textContent.trim();
                // movie_page=1;
            }
            if(item.classList.contains("menu-attributes-page")){
                movie_page = this.textContent.trim();
                movie_page_num = parseInt(this.textContent.trim());
            }
            if(item.classList.contains("menu-attributes-sort")){
                movie_sort_value = this.textContent.trim();
                // movie_page=1;
            }
            if(item.classList.contains("menu-attributes-sort-button")){
                if(movie_sort_number==1&&movie_flag==0){
                    movie_sort_type="asc";
                    movie_sort_number=2;
                    movie_flag=1;
                }
                if(movie_sort_number==2&&movie_flag==0){
                    movie_sort_type="desc";
                    movie_sort_number=1;
                    movie_flag=0;
                }else{
                    movie_flag=0;
                }
                
            }
            if(item.classList.contains("menu-attributes-next-button")){
                movie_page_num+=1;
                movie_page = toString(movie_page_num);
            }
            if(item.classList.contains("menu-attributes-before-button")){
                if(movie_page_num>1){
                    movie_page_num-=1;
                    movie_page = toString(movie_page_num);
                }
            }
            if(item.classList.contains("menu-attributes-all-button")){
                all_flag++;
                movie_genre = "- All -";
                movie_year = "";
                movie_rating =0;
                rating_flag =0;
                movie_age_rating = "";
                movie_page_num=1;
                movie_page="";
                document.getElementById("select-text1").innerHTML ="Select";
                document.getElementById("select-text2").innerHTML ="Select";
                document.getElementById("select-text3").innerHTML ="Select";
                document.getElementById("select-text4").innerHTML ="Select";
            }
            // var container_1 = document.getElementById("movie-list");
            // container_1.innerHTML = "";
            // var container = document.getElementById("movie-list");
            container.innerHTML ="";
            // var movie_rating_tmp = movie_rating;
            var j=0;
            var moviedata_tmp= [{}];
            var moviedata = "" ;
            for (var i=1;i<=10;++i){
            console.log(i+"Time");
 
            
            if (rating_flag!=0){ 
                movie_rating=parseFloat(movie_rating.toFixed(1));
                

            }
            
            console.log(movie_rating + "After loop");
            document.getElementById("current-genre").innerHTML = "Genre";
            if (this.textContent.trim()!= "- All -" && item.classList.contains("menu-attributes-genre"))
            document.getElementById("current-genre").innerHTML += ":" + this.textContent.trim();
            var xhr = new XMLHttpRequest();
           
            // var j=0;
            // var moviedata_tmp= [{}]; 
            var encodedURL_age_rating=encodeURIComponent(movie_age_rating);
            console.log("http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" +movie_year+"&rating=" +movie_rating+"&age_rating="+encodedURL_age_rating+"&page="+movie_page+"&sort="+movie_sort_value+","+movie_sort_type+"&search="+encodedURL_search_value);

            if (rating_flag==0){
                console.log("Inside rating_flag==0");
                    console.log("movie_year == - All -");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year +"&rating="+"&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
            }else{
                console.log("Inside rating_flag!=0");
                if (movie_rating_tmp1 == "- All -"){
                    console.log("Inside movie_rating_tmp1 == - All - ");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year+"&rating=- All -&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
                }else if(movie_rating_tmp1 != "- All -"){
                    console.log("Inside movie_rating_tmp1 != - All -");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year+"&rating="+movie_rating+"&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
                }else{
                    
                }
            }
            xhr.onload = function () {
                console.log(movie_rating + "Inside xhr.onload");
            if (xhr.status == 200) {
            console.log("Xhr status:"+xhr.status);
            console.log("http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" +movie_year+"&rating=" +movie_rating+"&age_rating="+encodedURL_age_rating+"&page="+movie_page+"&sort="+movie_sort_value+","+movie_sort_type+"&search="+encodedURL_search_value);
                // var container = document.getElementById("movie-list");
               
                // moviedata = JSON.parse(xhr.responseText); // Gán nội dung phản hồi vào biến movieData
                var response = JSON.parse(xhr.responseText);
                moviedata = response.movies;
                console.log("moviedata : " + moviedata); 
                console.log("J value: "+ j);
                moviedata.forEach(function(movie) {
 

                moviedata_tmp[j++]=movie;
                // console.log(moviedata_tmp[j]+"Moved movie");
                console.log(movie + "moviedata Movie");


                });
                    }
                    else {
                        console.error('Error:', xhr.statusText);
                    }
                };
                    xhr.onerror = function () {
                        console.error('Request failed');
                    };
                    xhr.send();
                console.log("Check all flag"+all_flag + "Check rating flag"+rating_flag);
                console.log(document.getElementById("select-text4").innerHTML);
                console.log("Movie rating_tmp1:"+movie_rating_tmp1+" Movie rating_flag:"+ rating_flag+" Movie select-text4:"+ document.getElementById("select-text4").innerHTML )
                if (movie_rating_tmp1 != "- All -"&& rating_flag != 0) movie_rating+=0.1;
                else  {break; console.log("Breaked");}
                }
 
                movie_rating = movie_rating_tmp;
                function sortMovieAscending(moviedata) {
                    if(movie_sort_value=="Rating"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].average_rating>moviedata[j].average_rating){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                    if(movie_sort_value=="Year"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].year>moviedata[j].year){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                }
                
                function sortMovieDescending(moviedata) {
                    if(movie_sort_value=="Rating"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].average_rating<moviedata[j].average_rating){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                    if(movie_sort_value=="Year"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].year<moviedata[j].year){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                }
                if(movie_sort_type=="asc"){
                    sortMovieAscending(moviedata_tmp);
                }
                if(movie_sort_type=="desc"){
                    sortMovieDescending(moviedata_tmp);
                }
                if (typeof (moviedata_tmp[0].title) != 'undefined'){
                moviedata_tmp.forEach(function(movie) {
                console.log(movie.title);
                var movieHTML =  `
 
                    <div class = "movie-area" >
                            <div class= "movie-wrap-plr">
                                <div class="movie-wrap text-center movie-wrap-text-center1 " class="img-movie" style="width:178.65px; height:250px;" >
                                    <div class="movie-img movie-img1" >
                                            <a href="  " ><img src= "${movie.thumbnail_path}"  alt=" "  ></a>
 
                                    </div>
                                    <div class="movie-content">
                                            <h3 class="title"><a href=" ">  ${movie.title} </a></h3>
                                            <span>Rating: ${movie.average_rating}  </span>
                                            <div class="movie-btn"> 
                                                <a href="review.html?movie_id=${movie.id}"    class="btn-style-hm4-2 animated">See details</a>
                                            </div> 
                                    </div>
                                    
                                </div>
                            </div>
                    </div>

                `;
                container.innerHTML += movieHTML;
                console.log("added film");

                });
                }else{ container.innerHTML = "";}
                // if (moviedata = [{}]) container.innerHTML = "";
            }
       
        );
  
            });        
  
            
        const search_value = document.querySelector('.search-movie');
        search_value.addEventListener("change",get_search_value);
        function get_search_value(e) {
            const button_search = document.querySelector('.button-search');
            button_search.addEventListener("click",function(){
                // menuItems.forEach(function(item) {
        // item.addEventListener('click', function() {
            console.log("Movie genre begin of button:"+movie_genre);
            console.log("Movie movie_year begin of button:"+movie_year);
            console.log("Movie movie_rating begin of button:"+movie_rating);
            console.log("Movie movie_rating begin of button:"+movie_rating_tmp);
            console.log("Movie rating_flag begin of button:"+rating_flag);
            console.log("Movie all_flag begin of button:"+all_flag);
            console.log("Movie movie_age_rating begin of button:"+movie_age_rating);
            console.log("Movie movie_search begin of button:"+movie_search);
            console.log("Movie movie_page begin of button:"+movie_page);
            console.log("Movie movie_sort_value begin of button:"+movie_sort_value);
            console.log("Movie movie_sort_type begin of button:"+movie_sort_type);
            console.log("Movie movie_sort_number begin of button:"+movie_sort_number);
            console.log("Movie movie_flag begin of button:"+movie_flag);
            console.log("Movie j begin of button:"+j);
            console.log("Movie moviedata_tmp begin of button:"+moviedata_tmp);
    
            container.innerHTML ="";
            var movie_rating_tmp = movie_rating;
            var moviedata = "" ;
            var j=0;
            var moviedata_tmp= [{}];
            for (var i=1;i<=10;++i){
 
            if (rating_flag!=0){ 
                movie_rating=parseFloat(movie_rating.toFixed(1));
            }
            
            // console.log(movie_rating + "After loop");
            // document.getElementById("current-genre").innerHTML = "Genre";
            // if (this.textContent.trim()!= "- All -" && item.classList.contains("menu-attributes-genre"))
            // document.getElementById("current-genre").innerHTML += ":" + this.textContent.trim();
            var xhr = new XMLHttpRequest();
            // var moviedata = "" ;
            // var j=0;
            // var moviedata_tmp= [{}];
            var encodedURL_age_rating=encodeURIComponent(movie_age_rating);
            encodedURL_search_value=encodeURIComponent(e.target.value);
            console.log("http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" +movie_year+"&rating=" +movie_rating+"&age_rating="+encodedURL_age_rating+"&page="+movie_page+"&sort="+movie_sort_value+","+movie_sort_type+"&search="+encodedURL_search_value);

            if (rating_flag==0){
                console.log("Inside rating_flag==0");
                    console.log("movie_year == - All -");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year +"&rating="+"&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
            }else{
                console.log("Inside rating_flag!=0");
                if (movie_rating_tmp1 == "- All -"){
                    console.log("Inside movie_rating_tmp1 == - All - ");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year+"&rating=- All -&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
                }else if(movie_rating_tmp1 != "- All -"){
                    console.log("Inside movie_rating_tmp1 != - All -");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year+"&rating="+movie_rating+"&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
                }else{
                    
                }
            }
            xhr.onload = function () {
                console.log(movie_rating + "Inside xhr.onload");
            if (xhr.status === 200) {
                console.log(movie_rating + "Inside xhr.status");   
                console.log("http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" +movie_year+"&rating=" +movie_rating+"&age_rating="+encodedURL_age_rating+"&page="+movie_page+"&sort="+movie_sort_value+","+movie_sort_type+"&search="+encodedURL_search_value);
                // var container = document.getElementById("movie-list");
                // container.innerHTML = "";     
                // moviedata = JSON.parse(xhr.responseText); // Gán nội dung phản hồi vào biến movieData
                var response = JSON.parse(xhr.responseText);
                moviedata = response.movies;
                console.log("Movie data: "+moviedata);

 
                // console.log(item.textContent.trim());
                moviedata.forEach(function(movie) {

                moviedata_tmp[j++]=movie;

                });
                    }
                    else {
                        console.error('Error:', xhr.statusText);
                    }
                };
                    xhr.onerror = function () {
                        console.error('Request failed');
                    };
                    xhr.send();
                console.log("Check all flag"+all_flag + "Check rating flag"+rating_flag);
                if (movie_rating_tmp1 != "- All -" &&rating_flag!=0) movie_rating+=0.1;
                else  break;
                }
 
                movie_rating = movie_rating_tmp;
                function sortMovieAscending(moviedata) {
                    if(movie_sort_value=="Rating"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].average_rating>moviedata[j].average_rating){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                    if(movie_sort_value=="Year"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].year>moviedata[j].year){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                }
                
                function sortMovieDescending(moviedata) {
                    if(movie_sort_value=="Rating"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].average_rating<moviedata[j].average_rating){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                    if(movie_sort_value=="Year"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].year<moviedata[j].year){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                }
                if(movie_sort_type=="asc"){
                    sortMovieAscending(moviedata_tmp);
                }
                if(movie_sort_type=="desc"){
                    sortMovieDescending(moviedata_tmp);
                }
                if (typeof (moviedata_tmp[0].title) != 'undefined'){
                moviedata_tmp.forEach(function(movie) {
                var movieHTML =  `
 
                <div class = "movie-area" >
                            <div class= "movie-wrap-plr">
                                <div class="movie-wrap text-center movie-wrap-text-center1 " class="img-movie" style="width:178.65px; height:250px;" >
                                    <div class="movie-img movie-img1" >
                                            <a href="  " ><img src= "${movie.thumbnail_path}"  alt=" "  ></a>

                                    </div>
                                    <div class="movie-content">
                                            <h3 class="title"><a href=" ">  ${movie.title} </a></h3>
                                            <span>Rating: ${movie.average_rating}  </span>
                                            <div class="movie-btn"> 
                                                <a href="href="review.html?movie_id=${movie.id}"    class="btn-style-hm4-2 animated">See details</a>
                                            </div> 
                                    </div>
                                    
                                </div>
                            </div>
                    </div>

                `;
                container.innerHTML += movieHTML;
                console.log("added film");

                });
                }
            // });
  
            // });







            });

            container.innerHTML ="";
            // var movie_rating_tmp = movie_rating;
            var j=0;
            var moviedata_tmp= [{}];
            var moviedata = "" ;
            for (var i=1;i<=10;++i){
            console.log(i+"Time");
 
            
            if (rating_flag!=0){ 
                movie_rating=parseFloat(movie_rating.toFixed(1));
                

            }
            
            console.log(movie_rating + "After loop");
            var xhr = new XMLHttpRequest();
           
            // var j=0;
            // var moviedata_tmp= [{}]; 
            // console.log("movie"+movie_age_rating+"Movie encodedURL"+encodedURL_search_value);
            encodedURL_search_value=encodeURIComponent(e.target.value);
            var encodedURL_age_rating=encodeURIComponent(movie_age_rating);
            console.log("http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" +movie_year+"&rating=" +movie_rating+"&age_rating="+encodedURL_age_rating+"&page="+movie_page+"&sort="+movie_sort_value+","+movie_sort_type+"&search="+encodedURL_search_value);

            if (rating_flag==0){
                console.log("Inside rating_flag==0");
                    console.log("movie_year == - All -");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year +"&rating="+"&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
            }else{
                console.log("Inside rating_flag!=0");
                if (movie_rating_tmp1 == "- All -"){
                    console.log("Inside movie_rating_tmp1 == - All - ");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year+"&rating=- All -&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
                }else if(movie_rating_tmp1 != "- All -"){
                    console.log("Inside movie_rating_tmp1 != - All -");
                    xhr.open("GET", "http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" + movie_year+"&rating="+movie_rating+"&age_rating=" + encodedURL_age_rating +"&page=" + movie_page +"&sort=" + movie_sort_value + "," + movie_sort_type +"&search=" + encodedURL_search_value, false);
                }else{
                    
                }
            }
            // var container = document.getElementById("movie-list");
            xhr.onload = function () {
                console.log(movie_rating + "Inside xhr.onload");
            if (xhr.status == 200) {
            console.log("Xhr status:"+xhr.status);
            console.log("http://localhost:3000/api/movies?genre=" + movie_genre +"&year=" +movie_year+"&rating=" +movie_rating+"&age_rating="+encodedURL_age_rating+"&page="+movie_page+"&sort="+movie_sort_value+","+movie_sort_type+"&search="+movie_search);
                // var container = document.getElementById("movie-list");
               
                // moviedata = JSON.parse(xhr.responseText); // Gán nội dung phản hồi vào biến movieData
                var response = JSON.parse(xhr.responseText);
                moviedata = response.movies;
              
                console.log("J value: "+ j);
                moviedata.forEach(function(movie) {

                moviedata_tmp[j++]=movie;
                console.log(moviedata_tmp[j]+"Moved movie");
                console.log(movie);


                });
                    }
                    else {
                        console.error('Error:', xhr.statusText);
                    }
                };
                    xhr.onerror = function () {
                        console.error('Request failed');
                    };
                    xhr.send();
                console.log("Check all flag"+all_flag + "Check rating flag"+rating_flag);
                console.log(document.getElementById("select-text4").innerHTML);
                if (movie_rating_tmp1 != "- All -"&&rating_flag!=0) movie_rating+=0.1;
                else  {break; console.log("Breaked");}
                }
 
                movie_rating = movie_rating_tmp;
                function sortMovieAscending(moviedata) {
                    if(movie_sort_value=="Rating"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].average_rating>moviedata[j].average_rating){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                    if(movie_sort_value=="Year"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].year>moviedata[j].year){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                }
                
                function sortMovieDescending(moviedata) {
                    if(movie_sort_value=="Rating"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].average_rating<moviedata[j].average_rating){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                    if(movie_sort_value=="Year"){
                        for(let i=0;i<moviedata.length-1;++i){
                            for(let j=i+1;j<moviedata.length;++j){
                                if(moviedata[i].year<moviedata[j].year){
                                    let tmp = moviedata[i];
                                    moviedata[i]=moviedata[j];
                                    moviedata[j]=tmp;
                                }
                            }
                        }
                    }
                }
                if(movie_sort_type=="asc"){
                    sortMovieAscending(moviedata_tmp);
                }
                if(movie_sort_type=="desc"){
                    sortMovieDescending(moviedata_tmp);
                }
                if (typeof (moviedata_tmp[0].title) != 'undefined'){
                moviedata_tmp.forEach(function(movie) {
                console.log(movie.title);
                var movieHTML =  `
 
                        <div class = "movie-area" >
                            <div class= "movie-wrap-plr">
                                <div class="movie-wrap text-center movie-wrap-text-center1 " class="img-movie" style="width:178.65px; height:250px;" >
                                    <div class="movie-img movie-img1" >
                                            <a href="  " ><img src= "${movie.thumbnail_path}"  alt=" "  ></a>

                                    </div>
                                    <div class="movie-content">
                                            <h3 class="title"><a href=" ">  ${movie.title} </a></h3>
                                            <span>Rating: ${movie.average_rating}  </span>
                                            <div class="movie-btn"> 
                                                <a href="href="review.html?movie_id=${movie.id}"    class="btn-style-hm4-2 animated">See details</a>
                                            </div> 
                                    </div>
                                    
                                </div>
                            </div>
                        </div>

                `;
                container.innerHTML += movieHTML;
                console.log("added film");

                });
                }else{ container.innerHTML = "";}
        }                


        

 
            
        </script>
                        

                        
</body>

</html>